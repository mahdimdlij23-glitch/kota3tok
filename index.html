<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kota3Tok - Ù‚Ø·Ø¹ ØºÙŠØ§Ø±</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
body { margin:0; font-family:'Tajawal',sans-serif; background:linear-gradient(135deg,#0b122e,#1b1f3a); color:#fff; overflow-x:hidden; }
header { background:#11182b; display:flex; justify-content:space-between; align-items:center; padding:10px 20px; position:fixed; width:100%; top:0; z-index:1000; box-shadow:0 4px 10px rgba(0,0,0,0.5); }
header h1 { margin:0; font-size:26px; font-weight:700; }
.menu-btn { cursor: pointer; font-size:32px; color:#fff; z-index:1001; transition: transform 0.2s; }
.menu-btn:hover { transform: scale(1.2); }
#adminPanel { display:none; position:fixed; top:60px; right:10px; background:#11182b; padding:15px; border-radius:14px; width:300px; max-height:80vh; overflow-y:auto; box-shadow:0 8px 20px rgba(0,0,0,0.6); z-index:2000; }
#adminPanel input, #adminPanel select { width:100%; margin-bottom:10px; padding:6px; border-radius:6px; border:none; background:#1e2b4d; color:#fff; }
#adminPanel button { width:100%; padding:8px; border:none; border-radius:6px; background:#2e3a61; color:#fff; cursor:pointer; margin-bottom:5px; transition:transform 0.2s,background 0.2s; }
#adminPanel button:hover { transform:scale(1.05); background:#3b4a82; }
main { margin-top:80px; padding:20px; }
.section { margin-bottom:30px; cursor:pointer; }
.section h2 { margin-bottom:10px; border-bottom:1px solid #444; padding-bottom:5px; }
.itemsList { display:none; padding-left:0; margin:0; }
.item { display:flex; justify-content:space-between; padding:8px 0; border-bottom:1px solid #333; }
.item button { margin-left:5px; padding:2px 6px; font-size:14px; cursor:pointer; border-radius:4px; border:none; }
.edit-btn { background:#ff9800; color:#fff; }
.delete-btn { background:#f44336; color:#fff; }
/* Floating Buttons */
.floating-btn { position:fixed; bottom:20px; border:none; border-radius:50%; width:50px; height:50px; font-size:22px; display:flex; justify-content:center; align-items:center; cursor:pointer; z-index:2000; box-shadow:0 4px 8px rgba(0,0,0,0.4); transition:transform 0.2s; }
.floating-btn:hover { transform:scale(1.1); }
.floating-search { right:20px; background:#1e2b4d; color:#fff; }
.floating-whatsapp { right:80px; background:#25D366; color:#fff; text-decoration:none; }
.floating-delivery { right:140px; background:#f39c12; color:#fff; text-decoration:none; }
#searchInput { display:none; position:fixed; bottom:80px; right:20px; width:200px; padding:6px; border-radius:8px; border:none; background:#1e2b4d; color:#fff; z-index:2001; }
/* Delivery Modal */
.modal { display:none; position:fixed; z-index:3000; left:0; top:0; width:100%; height:100%; overflow:auto; background-color: rgba(0,0,0,0.7); }
.modal-content { background-color:#1e2b4d; margin:15% auto; padding:20px; border-radius:12px; width:90%; max-width:400px; color:#fff; }
.close { float:right; font-size:24px; cursor:pointer; }
@media(max-width:600px){ #adminPanel{width:90%; right:5%;} #searchInput{width:150px;} }
</style>
</head>
<body>

<header>
<h1>Kota3Tok</h1>
<div class="menu-btn">&#9776;</div> <!-- Ø«Ù„Ø§Ø« Ø®Ø·ÙˆØ· Ø£ÙÙ‚ÙŠØ© -->
</header>

<div id="adminPanel">
<h3>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
<input type="text" id="itemName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø·Ø¹Ø©">
<input type="number" id="itemPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<select id="itemCategory">
<option value="spare">Ù‚Ø·Ø¹ ØºÙŠØ§Ø±</option>
<option value="accessory">Ù‚Ø·Ø¹ Ø²ÙŠÙ†Ø© ÙˆØ§ÙƒØ³Ø³ÙˆØ§Ø±</option>
</select>
<button id="addItemBtn">Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„</button>
</div>

<main>
<div class="section" id="spareSection"><h2>Ù‚Ø·Ø¹ ØºÙŠØ§Ø±</h2>
<div class="itemsList" id="spareList"></div>
</div>
<div class="section" id="accessorySection"><h2>Ù‚Ø·Ø¹ Ø²ÙŠÙ†Ø© ÙˆØ§ÙƒØ³Ø³ÙˆØ§Ø±</h2>
<div class="itemsList" id="accessoryList"></div>
</div>
</main>

<input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø·Ø¹Ø©...">
<a href="https://wa.me/96170956420" target="_blank" class="floating-btn floating-whatsapp">ğŸ’¬</a>
<button class="floating-btn floating-search">&#128269;</button>
<button class="floating-btn floating-delivery">!</button>

<div id="deliveryModal" class="modal">
<div class="modal-content">
<span class="close">&times;</span>
<h2>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ³Ù„ÙŠÙ…</h2>
<p>ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø¬Ø² ÙŠÙƒÙˆÙ† Ø¨Ø¹Ø¯ Ø¯ÙØ¹ Ø§Ù„Ù…Ø¨Ù„Øº.</p>
<p>ÙˆÙ‚Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø·Ù„Ø¨ Ø£Ø³Ø¨ÙˆØ¹ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹.</p>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyDoi4EAAdWJ9BUbLc3mP1zuNXXUd7a4Dn4",
authDomain: "kota3tok.firebaseapp.com",
projectId: "kota3tok",
storageBucket: "kota3tok.appspot.com",
messagingSenderId: "322095191128",
appId: "1:322095191128:web:f5e06d891041097302662d",
measurementId: "G-YN09RQSFBK"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Admin Panel Toggle
const menuBtn = document.querySelector(".menu-btn");
const adminPanel = document.getElementById("adminPanel");
menuBtn.onclick = () => {
  const password = prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±:");
  if(password === "Kt3-Admin-01"){
    adminPanel.style.display = adminPanel.style.display === "block" ? "none" : "block";
    loadItems();
  }
};

// Toggle Sections
document.getElementById("spareSection").onclick = () => {
  const list = document.getElementById("spareList");
  list.style.display = list.style.display==="block"?"none":"block";
};
document.getElementById("accessorySection").onclick = () => {
  const list = document.getElementById("accessoryList");
  list.style.display = list.style.display==="block"?"none":"block";
};

const loadItems = async () => {
  const spareList = document.getElementById("spareList");
  const accessoryList = document.getElementById("accessoryList");
  spareList.innerHTML = "";
  accessoryList.innerHTML = "";

  const spareSnap = await getDocs(collection(db, "spare"));
  spareSnap.forEach(docItem=>{
    const data = docItem.data();
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML=`<span>${data.name} (${data.note || "Ø§Ù„Ø³Ø¹Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ùˆ Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒØ§Ù„Ø© +2$"})</span><span>${data.price}$</span>`;
    if(adminPanel.style.display==="block"){
      const editBtn = document.createElement("button");
      editBtn.className="edit-btn";
      editBtn.textContent="âœï¸";
      editBtn.onclick=()=>{
        document.getElementById("itemName").value=data.name;
        document.getElementById("itemPrice").value=data.price;
        document.getElementById("itemCategory").value="spare";
      };
      const delBtn=document.createElement("button");
      delBtn.className="delete-btn";
      delBtn.textContent="ğŸ—‘ï¸";
      delBtn.onclick=async()=>{
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø·Ø¹Ø©ØŸ")){
          await deleteDoc(doc(db,"spare",docItem.id));
          loadItems();
        }
      };
      div.appendChild(editBtn);
      div.appendChild(delBtn);
    }
    spareList.appendChild(div);
  });

  const accSnap = await getDocs(collection(db, "accessory"));
  accSnap.forEach(docItem=>{
    const data = docItem.data();
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML=`<span>${data.name} (${data.note || "Ø§Ù„Ø³Ø¹Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ùˆ Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒØ§Ù„Ø© +2$"})</span><span>${data.price}$</span>`;
    if(adminPanel.style.display==="block"){
      const editBtn = document.createElement("button");
      editBtn.className="edit-btn";
      editBtn.textContent="âœï¸";
      editBtn.onclick=()=>{
        document.getElementById("itemName").value=data.name;
        document.getElementById("itemPrice").value=data.price;
        document.getElementById("itemCategory").value="accessory";
      };
      const delBtn=document.createElement("button");
      delBtn.className="delete-btn";
      delBtn.textContent="ğŸ—‘ï¸";
      delBtn.onclick=async()=>{
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø·Ø¹Ø©ØŸ")){
          await deleteDoc(doc(db,"accessory",docItem.id));
          loadItems();
        }
      };
      div.appendChild(editBtn);
      div.appendChild(delBtn);
    }
    accessoryList.appendChild(div);
  });
};

// Add / Update Item
document.getElementById("addItemBtn").onclick = async ()=>{
  const name=document.getElementById("itemName").value;
  const price=document.getElementById("itemPrice").value;
  const category=document.getElementById("itemCategory").value;
  if(!name || !price) return alert("Ø£ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
  const itemsRef = collection(db, category);
  const snapshot = await getDocs(itemsRef);
  let updated=false;
  snapshot.forEach(async docItem=>{
    if(docItem.data().name===name){
      await updateDoc(doc(db,category,docItem.id), {price:Number(price)});
      updated=true;
      loadItems();
    }
  });
  if(!updated){ await addDoc(itemsRef,{name:name,price:Number(price),note:"Ø§Ù„Ø³Ø¹Ø± Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ùˆ Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒØ§Ù„Ø© +2$"}); loadItems(); }
  document.getElementById("itemName").value="";
  document.getElementById("itemPrice").value="";
};
</script>

<script>
// Floating Search
const searchBtn = document.querySelector(".floating-search");
const searchInput = document.getElementById("searchInput");
searchBtn.onclick = ()=>{ searchInput.style.display = searchInput.style.display==="block"?"none":"block"; };

// Delivery Modal
const deliveryBtn = document.querySelector(".floating-delivery");
const modal = document.getElementById("deliveryModal");
const closeBtn = document.querySelector(".close");
deliveryBtn.onclick = ()=>{ modal.style.display="block"; };
closeBtn.onclick = ()=>{ modal.style.display="none"; };
window.onclick = (e)=>{ if(e.target===modal) modal.style.display="none"; };
</script>

</body>
</html>
